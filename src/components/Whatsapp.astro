<style>
  /* --- CLASES CSS BASE --- */
  .wa-tooltip-hidden {
    opacity: 0;
    transform: translateY(5px);
    pointer-events: none;
  }

  .wa-tooltip-visible {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
  }

  .element-hidden {
    display: none !important;
  }

  #wa-tooltip {
    width: calc(100vw - 32px);
    min-height: 180px;
    left: 0;
    right: auto;
    bottom: 50px;
  }

  .wa-message-bubble {
    font-size: 0.875rem;
    padding: 0.75rem;
  }

  #wa-tooltip .wa-message-bubble::before {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 8px;
    width: 0;
    height: 0;
    border-top: 8px solid #e5e7eb;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    transform: rotate(25deg);
    transform-origin: 0% 100%;
  }

  #wa-tooltip .wa-main-pointer {
    position: absolute;
    bottom: -15px;
    right: 18px;
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-top: 15px solid white;
  }

  /* --- AJUSTES PARA PANTALLAS GRANDES (MEDIA QUERY: > 640px) --- */
  @media (min-width: 640px) {
    #wa-tooltip {
      width: 500px;
      min-height: 300px;
      /* Vuelve a su posición fija original */
      right: 0;
      left: auto;
      bottom: 112px; /* bottom-24 (96px) + un poco más si se movió antes */
    }

    /* Restaurar el tamaño del contenido para escritorio */
    .wa-message-bubble {
      font-size: 1rem;
      padding: 1.25rem;
    }

    /* Restaurar el tamaño de la cabecera y el botón para escritorio */
    #wa-tooltip .bg-\[\#25D366\] {
      padding: 1.25rem;
      font-size: 1.125rem;
    }

    #wa-chat-action-button {
      padding: 1rem 1.5rem;
      font-size: 1rem;
    }

    #wa-tooltip .bg-white {
      padding: 1.5rem;
    }
  }
</style>
<div
  class="fixed right-4 left-4 sm:right-6 sm:left-auto bottom-4 z-70 flex flex-col items-end"
  id="wa-wrapper"
>
  <div
    id="wa-tooltip"
    class="absolute right-0 bottom-14 overflow-hidden rounded-xl bg-white shadow-xl transition-all duration-300 ease-in-out wa-tooltip-hidden"
    style="z-index: 99;"
  >
    <div class="flex items-center justify-between bg-[#25D366] p-3 rounded-t-xl">
      <div class="flex items-center text-white">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          class="mr-2 h-6 w-6"
        >
          <path
            d="M20.52 3.48A11.9 11.9 0 0012 .1C5.64.1.64 5.1.64 11.46c0 2.02.53 3.96 1.53 5.68L.1 23.9l6.98-1.83a11.36 11.36 0 005.02 1.06h.02c6.36 0 11.36-5 11.36-11.36 0-3.03-1.18-5.86-3.44-7.69zM12.02 20.5h-.01a9.07 9.07 0 01-4.63-1.27l-.33-.2-4.14 1.09 1.11-4.03-.21-.34A9.09 9.09 0 012.95 11.5c0-5.01 4.08-9.09 9.09-9.09 2.43 0 4.7.95 6.41 2.67a9.02 9.02 0 01-6.43 15.42z"
          ></path>
          <path
            d="M17.06 14.33c-.29-.15-1.72-.85-1.99-.95-.27-.1-.47-.15-.67.15-.2.29-.77.95-.94 1.15-.17.2-.34.22-.63.07-.29-.15-1.21-.44-2.3-1.42-.85-.76-1.42-1.7-1.59-1.99-.17-.29-.02-.45.13-.6.13-.13.29-.34.44-.5.15-.17.2-.29.3-.48.1-.2 0-.37-.05-.52-.07-.15-.67-1.62-.92-2.21-.24-.58-.49-.5-.67-.51-.17 0-.37-.01-.56-.01-.19 0-.5.07-.76.37-.26.29-1 1-1 2.44 0 1.44 1.03 2.84 1.17 3.04.15.2 2.02 3.1 4.9 4.35 2.34 1.03 2.34.69 2.76.65.42-.05 1.36-.55 1.56-1.09.2-.54.2-1 .14-1.09-.07-.09-.26-.15-.55-.29z"
          ></path>
        </svg>
        <span class="font-medium">WhatsApp</span>
      </div>
      <button id="wa-close-button" class="text-white hover:text-gray-200">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2.5"
          stroke="currentColor"
          class="h-5 w-5 cursor-pointer"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <div class="bg-white p-4">
      <div class="relative mb-3 w-[75%] rounded-xl bg-gray-100 text-gray-800 wa-message-bubble">
        Hola! ¿Aún no has dado el paso?
      </div>

      <a
        id="wa-chat-action-button"
        href="#"
        target="_blank"
        rel="noopener noreferrer"
        class="float-right inline-flex items-center justify-center rounded-xl bg-[#25D366] px-4 py-3 text-sm font-semibold text-white shadow-md transition-colors hover:bg-[#1fae51] group"
      >
        Empieza en CrossFit Tempus!
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          class="ml-2 h-5 w-5 transition-transform duration-200 group-hover:translate-x-0.5"
        >
          <path
            d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"
          ></path>
        </svg>
      </a>
      <div class="clear-both"></div>
    </div>

    <div class="wa-main-pointer"></div>
  </div>

  <a
    id="wa-icon-button"
    href="#"
    aria-label="Abrir WhatsApp"
    class="inline-flex h-14 w-14 items-center justify-center rounded-full bg-[#25D366] text-white shadow-lg transition-transform duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#128C7E]"
    style="z-index: 100;"
  >
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-7 w-7">
      <path
        d="M20.52 3.48A11.9 11.9 0 0012 .1C5.64.1.64 5.1.64 11.46c0 2.02.53 3.96 1.53 5.68L.1 23.9l6.98-1.83a11.36 11.36 0 005.02 1.06h.02c6.36 0 11.36-5 11.36-11.36 0-3.03-1.18-5.86-3.44-7.69zM12.02 20.5h-.01a9.07 9.07 0 01-4.63-1.27l-.33-.2-4.14 1.09 1.11-4.03-.21-.34A9.09 9.09 0 012.95 11.5c0-5.01 4.08-9.09 9.09-9.09 2.43 0 4.7.95 6.41 2.67a9.02 9.02 0 01-6.43 15.42z"
      ></path>
      <path
        d="M17.06 14.33c-.29-.15-1.72-.85-1.99-.95-.27-.1-.47-.15-.67.15-.2.29-.77.95-.94 1.15-.17.2-.34.22-.63.07-.29-.15-1.21-.44-2.3-1.42-.85-.76-1.42-1.7-1.59-1.99-.17-.29-.02-.45.13-.6.13-.13.29-.34.44-.5.15-.17.2-.29.3-.48.1-.2 0-.37-.05-.52-.07-.15-.67-1.62-.92-2.21-.24-.58-.49-.5-.67-.51-.17 0-.37-.01-.56-.01-.19 0-.5.07-.76.37-.26.29-1 1-1 2.44 0 1.44 1.03 2.84 1.17 3.04.15.2 2.02 3.1 4.9 4.35 2.34 1.03 2.34.69 2.76.65.42-.05 1.36-.55 1.56-1.09.2-.54.2-1 .14-1.09-.07-.09-.26-.15-.55-.29z"
      ></path>
    </svg>
  </a>
</div>

<script>
  const phone = '+34690854880'
  const defaultMessage =
    'Hola!%20Me%20gustaría%20recibir%20más%20información%20sobre%20las%20clases%20de%20Tempus%20Funcional%20Fitness.'
  const whatsappHref = `https://wa.me/${phone}?text=${defaultMessage}`

  const WA_HIDDEN_CLASSES = ['wa-tooltip-hidden']
  const WA_VISIBLE_CLASSES = ['wa-tooltip-visible']
  const ELEMENT_HIDDEN_CLASS = 'element-hidden'

  const waWrapper = document.getElementById('wa-wrapper')
  const waIconButton = document.getElementById('wa-icon-button')
  const waTooltip = document.getElementById('wa-tooltip')
  const waCloseButton = document.getElementById('wa-close-button')
  const waActionButton = document.getElementById('wa-chat-action-button')

  waActionButton.href = whatsappHref
  waIconButton.href = whatsappHref

  const showTooltip = () => {
    waTooltip.classList.remove(...WA_HIDDEN_CLASSES)
    waTooltip.classList.add(...WA_VISIBLE_CLASSES)
  }

  const hideTooltip = () => {
    waTooltip.classList.remove(...WA_VISIBLE_CLASSES)
    waTooltip.classList.add(...WA_HIDDEN_CLASSES)
  }

  const showIcon = () => {
    waIconButton.classList.remove(ELEMENT_HIDDEN_CLASS)
  }

  const hideIcon = () => {
    waIconButton.classList.add(ELEMENT_HIDDEN_CLASS)
  }

  hideTooltip()
  showIcon()

  setTimeout(() => {
    if (
      !waTooltip.classList.contains(WA_VISIBLE_CLASSES[0]) &&
      !waIconButton.classList.contains(ELEMENT_HIDDEN_CLASS)
    ) {
      hideIcon()
      showTooltip()
    }
  }, 5000)

  waIconButton.addEventListener('click', (e) => {
    e.preventDefault()
    hideIcon()
    showTooltip()
  })

  waActionButton.addEventListener('click', (e) => {
    hideTooltip()
    showIcon()
  })

  waCloseButton.addEventListener('click', (e) => {
    e.preventDefault()
    hideTooltip()
    showIcon()
  })
</script>
